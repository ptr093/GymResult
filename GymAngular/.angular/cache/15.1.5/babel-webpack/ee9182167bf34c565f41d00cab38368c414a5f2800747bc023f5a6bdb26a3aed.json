{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, ElementRef, ViewChildren } from '@angular/core';\nimport { FormControlName, Validators } from '@angular/forms';\nimport { debounceTime, fromEvent, merge } from 'rxjs';\nimport { GenericValidator } from '../generic-validator';\nfunction range(min, max) {\n  return c => {\n    if (c.value != null && isNaN(c.value) || c.value < min || c.value > max) {\n      return {\n        'range': true\n      };\n    }\n    console.log('Mussi wyswietlic teraz');\n    return null;\n  };\n}\nlet WorkoutEditComponent = class WorkoutEditComponent {\n  ngAfterViewInit() {\n    // Watch for the blur event from any input element on the form.\n    // This is required because the valueChanges does not provide notification on blur\n    const controlBlurs = this.formInputElements.map(formControl => fromEvent(formControl.nativeElement, 'blur'));\n    // Merge the blur event observable with the valueChanges observable\n    // so we only need to subscribe once.\n    merge(this.exerciseForm.valueChanges, ...controlBlurs).pipe(debounceTime(800)).subscribe(value => {\n      this.displayMessage = this.genericValidator.processMessages(this.exerciseForm);\n    });\n  }\n  constructor(fb, route, router, workoutService) {\n    this.fb = fb;\n    this.route = route;\n    this.router = router;\n    this.workoutService = workoutService;\n    this.pageTitle = 'Product Edit';\n    this.errorMessage = '';\n    // Use with the generic validation message class\n    this.displayMessage = {};\n    // Defines all of the validation messages for the form.\n    // These could instead be retrieved from a file or database.\n    this.validationMessages = {\n      category: {\n        required: 'Kategoria jest wymagana',\n        minlength: 'Kategoria musi zawierać conajmniej 3 znaki',\n        maxlength: 'Katoria nie może zawierać więcej niż 50 znaków.'\n      },\n      series: {\n        required: 'Seria jest wymagana',\n        range: \"Podaj numer serii\"\n      },\n      weight: {\n        required: 'Podaj ciężar',\n        range: \"Podaj wagę ciężaru\"\n      }\n    };\n    // Define an instance of the validator for use with this form,\n    // passing in this form's set of validation messages.\n    // Define an instance of the validator for use with this form,\n    // passing in this form's set of validation messages.\n    this.genericValidator = new GenericValidator(this.validationMessages);\n  }\n  ngOnInit() {\n    this.exerciseForm = this.fb.group({\n      category: [null, [Validators.required, Validators.minLength(3), Validators.maxLength(50)]],\n      weight: [null, Validators.required, range(1, 1000)],\n      series: [null, Validators.required, range(1, 1000)]\n    });\n    let trainingId = Number(this.route.snapshot.paramMap.get('trainingId'));\n    let id = Number(this.route.snapshot.paramMap.get('id'));\n    this.workoutId = trainingId;\n    if (id !== 0) {\n      // Read the product Id from the route parameter\n      this.sub = this.route.paramMap.subscribe(params => {\n        this.getExercise(trainingId, id);\n      });\n    }\n  }\n  ngOnDestroy() {\n    this.sub === undefined ? \"\" : this.sub.unsubscribe();\n  }\n  getExercise(idTraining, idExercise) {\n    this.workoutService.getExercise(idTraining, idExercise).subscribe({\n      next: exercise => this.displayExercise(exercise),\n      error: err => this.errorMessage = err\n    });\n  }\n  displayExercise(exercise) {\n    if (this.exerciseForm) {\n      this.exerciseForm.reset();\n    }\n    this.exercise = exercise;\n    if (this.exercise.id === 0 || this.exercise.id === null) {\n      this.pageTitle = 'Add Exercise';\n    } else {\n      this.pageTitle = `Edit Exercise: ${this.exercise.category}`;\n    }\n    // Update the data on the form\n    this.exerciseForm.patchValue({\n      category: this.exercise.category,\n      weight: this.exercise.weight,\n      series: this.exercise.series\n    });\n  }\n  deleteExercise() {\n    if (this.exercise.id === 0) {\n      // Don't delete, it was never saved.\n      this.onSaveComplete();\n    } else {\n      if (confirm(`Really delete the product: ${this.exercise.category}?`)) {\n        this.workoutService.deleteWorkout(this.exercise.trainingId, this.exercise.id).subscribe({\n          next: () => this.onSaveComplete(),\n          error: err => this.errorMessage = err\n        });\n      }\n    }\n  }\n  saveExercise() {\n    if (this.exerciseForm.valid) {\n      if (this.exerciseForm.dirty) {\n        const p = {\n          ...this.exercise,\n          ...this.exerciseForm.value\n        };\n        console.log(p.idExercise, p.category, p.series);\n        if (this.exercise === undefined) {\n          p.trainingId = this.workoutId;\n          this.workoutService.createWorkout(p).subscribe({\n            next: () => this.onSaveComplete(),\n            error: err => this.errorMessage = err\n          });\n        } else {\n          this.workoutService.updateWorkout(p).subscribe({\n            next: () => this.onSaveComplete(),\n            error: err => this.errorMessage = err\n          });\n        }\n      } else {\n        this.onSaveComplete();\n      }\n    } else {\n      this.errorMessage = 'Please correct the validation errors.';\n    }\n  }\n  onSaveComplete() {\n    // Reset the form to clear the flags\n    this.exerciseForm.reset();\n    this.router.navigate(['/workout']);\n  }\n};\n__decorate([ViewChildren(FormControlName, {\n  read: ElementRef\n})], WorkoutEditComponent.prototype, \"formInputElements\", void 0);\nWorkoutEditComponent = __decorate([Component({\n  templateUrl: './workout-edit.component.html',\n  styleUrls: ['./workout-edit.component.css']\n})], WorkoutEditComponent);\nexport { WorkoutEditComponent };","map":{"version":3,"mappings":"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","names":["Component","ElementRef","ViewChildren","FormControlName","Validators","debounceTime","fromEvent","merge","GenericValidator","range","min","max","c","value","isNaN","console","log","WorkoutEditComponent","ngAfterViewInit","controlBlurs","formInputElements","map","formControl","nativeElement","exerciseForm","valueChanges","pipe","subscribe","displayMessage","genericValidator","processMessages","constructor","fb","route","router","workoutService","validationMessages","category","required","minlength","maxlength","series","weight","ngOnInit","group","minLength","maxLength","trainingId","Number","snapshot","paramMap","get","id","workoutId","sub","params","getExercise","ngOnDestroy","undefined","unsubscribe","idTraining","idExercise","next","exercise","displayExercise","error","err","errorMessage","reset","pageTitle","patchValue","deleteExercise","onSaveComplete","confirm","deleteWorkout","saveExercise","valid","dirty","p","createWorkout","updateWorkout","navigate","__decorate","read","templateUrl","styleUrls"],"sourceRoot":"","sources":["D:\\repos\\GymResult\\GymAngular\\src\\app\\workout\\workout-edit.component.ts"],"sourcesContent":["import { AfterViewInit, Component, ElementRef, OnDestroy, OnInit, ViewChildren } from '@angular/core';\nimport { AbstractControl, FormBuilder, FormControlName, FormGroup, ValidatorFn, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { debounceTime, fromEvent, merge, Observable, Subscription } from 'rxjs';\nimport { GenericValidator } from '../generic-validator';\n\n\nimport { WorkoutService } from '../workout.service';\nimport { Exerceise } from './exercise';\nimport { Workout } from './workout';\n\nfunction range (min:number,max:number): ValidatorFn {\n  return  (c: AbstractControl):{[key:string]: boolean} | null => {\n   if(c.value !=null && (isNaN(c.value)) || c.value <min || c.value > max){\n  \n     return {'range': true}\n   }\n   console.log('Mussi wyswietlic teraz')\n   return null\n   }\n  }\n\n\n@Component({\n\n  templateUrl: './workout-edit.component.html',\n  styleUrls: ['./workout-edit.component.css']\n})\nexport class WorkoutEditComponent implements  OnInit, OnDestroy, AfterViewInit  {\n  @ViewChildren(FormControlName, { read: ElementRef }) public formInputElements!: ElementRef[] \n\n  pageTitle = 'Product Edit';\n  errorMessage: string  = '';\n public exerciseForm!: FormGroup \n\n  public exercise!: Exerceise \n  public sub!: Subscription;\n  public workoutId!:number;\n\n\n  \n  // Use with the generic validation message class\n  displayMessage: { [key: string |number]: string | number  | any} = {};\n  private validationMessages: { [key: string| number]: { [key: string |number]: string | any} };\n  \n  private genericValidator: GenericValidator;\n\n  ngAfterViewInit(): void {\n    // Watch for the blur event from any input element on the form.\n    // This is required because the valueChanges does not provide notification on blur\n    const controlBlurs: Observable<any>[] = this.formInputElements\n      .map((formControl: ElementRef) => fromEvent(formControl.nativeElement, 'blur'));\n\n    // Merge the blur event observable with the valueChanges observable\n    // so we only need to subscribe once.\n    merge(this.exerciseForm.valueChanges, ...controlBlurs).pipe(\n      debounceTime(800)\n    ).subscribe(value => {\n      this.displayMessage = this.genericValidator.processMessages(this.exerciseForm) ;\n    });\n  }\n\n  constructor(private fb: FormBuilder,\n              private route: ActivatedRoute,\n              private router: Router,\n              private workoutService: WorkoutService) {\n\n    // Defines all of the validation messages for the form.\n    // These could instead be retrieved from a file or database.\n   this.validationMessages = {\n      category: {\n        required: 'Kategoria jest wymagana',\n        minlength: 'Kategoria musi zawierać conajmniej 3 znaki',\n        maxlength: 'Katoria nie może zawierać więcej niż 50 znaków.'\n      },\n      series: {\n        required: 'Seria jest wymagana',\n        range:    \"Podaj numer serii\"\n      },\n      weight: {\n        required: 'Podaj ciężar',\n        range:    \"Podaj wagę ciężaru\"\n      }\n    };\n\n    // Define an instance of the validator for use with this form,\n    // passing in this form's set of validation messages.\n \n\n    // Define an instance of the validator for use with this form,\n    // passing in this form's set of validation messages.\n    this.genericValidator = new GenericValidator(this.validationMessages);\n  }\n\n\n\n  ngOnInit(): void {\n    this.exerciseForm = this.fb.group({\n      category: [null, [Validators.required,\n                         Validators.minLength(3),\n                         Validators.maxLength(50)]],\n      weight: [null, Validators.required,\n      range(1,1000)\n      ],\n      series: [null, Validators.required,\n        range(1,1000)\n                    ]\n      \n    });\n\n    let trainingId = Number(this.route.snapshot.paramMap.get('trainingId'));\n     let id = Number(this.route.snapshot.paramMap.get('id'));\n  \n   \n    this.workoutId=trainingId;\n\n\n     if (id !== 0){\n    // Read the product Id from the route parameter\n    this.sub = this.route.paramMap.subscribe(\n      params => {\n        \n        this.getExercise(trainingId,id);\n      }\n    );\n     }\n  }\n  \n\n\n  ngOnDestroy(): void {\n\n     this.sub ===undefined? \"\": this.sub.unsubscribe();\n  }\n\n \n\n  getExercise(idTraining: number,idExercise: number): void {\n\n\n   \n    this.workoutService.getExercise(idTraining,idExercise)\n      .subscribe({\n        next: (exercise: Exerceise) => this.displayExercise(exercise),\n        error: err => this.errorMessage = err\n      });\n  \n  }\n\n\n  \n\n\n\n  displayExercise(exercise: Exerceise): void {\n    if (this.exerciseForm) {\n      this.exerciseForm.reset();\n    }\n    this.exercise = exercise;\n\n\n\n    if (this.exercise.id === 0 || this.exercise.id === null) {\n      this.pageTitle = 'Add Exercise';\n    } else {\n      this.pageTitle = `Edit Exercise: ${this.exercise.category}`;\n    }\n\n    // Update the data on the form\n    this.exerciseForm.patchValue({\n      category: this.exercise.category,\n      weight: this.exercise.weight,\n      series: this.exercise.series,\n   \n    });\n  \n  }\n\n  deleteExercise(): void {\n    if (this.exercise.id === 0) {\n      // Don't delete, it was never saved.\n      this.onSaveComplete();\n    } else {\n      if (confirm(`Really delete the product: ${this.exercise.category}?`)) {\n        this.workoutService.deleteWorkout(this.exercise.trainingId,this.exercise.id)\n          .subscribe({\n            next: () => this.onSaveComplete(),\n            error: err => this.errorMessage = err\n          });\n      }\n    }\n  }\n\n  saveExercise(): void {\n    if (this.exerciseForm.valid) {\n      if (this.exerciseForm.dirty) {\n        const p = { ...this.exercise, ...this.exerciseForm.value };\n       \n        console.log(p.idExercise, p.category, p.series);\n        \n        if ( this.exercise=== undefined) {\n          p.trainingId =this.workoutId\n          this.workoutService.createWorkout(p)\n            .subscribe({\n              next: () => this.onSaveComplete(),\n              error: err => this.errorMessage = err\n            });\n        } \n        else {\n          this.workoutService.updateWorkout(p)\n            .subscribe({\n              next: () => this.onSaveComplete(),\n              error: err => this.errorMessage = err\n            });\n        }\n      } else {\n        this.onSaveComplete();\n      }\n    } else {\n      this.errorMessage = 'Please correct the validation errors.';\n    }\n  }\n\n  onSaveComplete(): void {\n    // Reset the form to clear the flags\n    this.exerciseForm.reset();\n    this.router.navigate(['/workout']);\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}